(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c9af9"],{"59cb":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"animated fadeIn"},[r("b-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("strong",[e._v("Purchase Create ")]),r("small",[e._v("Form")])]),e.show?r("b-form",{on:{submit:e.onSubmit,reset:e.onReset,keydown:function(t){return e.$errors.onKeydown(t)}}},[r("b-row",[r("b-col",[r("b-form-group",{attrs:{label:"Date:","label-for":"date","invalid-feedback":e.$errors.first("date"),state:!e.$errors.has("date")}},[r("date-time-picker",{attrs:{clearable:"",name:"date",format:"DD-MM-YYYY HH:mm:ss"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Reference:","label-for":"reference","invalid-feedback":e.$errors.first("reference"),state:!e.$errors.has("reference")}},[r("b-form-input",{attrs:{id:"reference",type:"text",state:!e.$errors.has("reference"),placeholder:"Enter reference"},model:{value:e.form.reference,callback:function(t){e.$set(e.form,"reference",t)},expression:"form.reference"}})],1)],1)],1),r("b-form-group",{attrs:{label:"Search Product:","label-for":"searchProduct","invalid-feedback":e.$errors.first("products"),state:!e.$errors.has("products")}},[r("vue-select",{attrs:{items:e.products,loading:e.$errors.busy,"item-text":"name",placeholder:"Search product by code or name and can scan by barcode","disable-filtering-by-search":""},on:{select:e.selectedItem},scopedSlots:e._u([{key:"item",fn:function(t){var s=t.item;return[r("div",{staticStyle:{display:"flex","align-items":"center"}},[s.file?r("img",{staticClass:"logo",attrs:{src:s.file,width:"100px"}}):e._e(),r("div",{staticClass:"product-detail"},[r("span",{staticClass:"item-name"},[e._v("Name: "+e._s(s.name)+" ")]),r("br"),r("span",{staticClass:"item-name"},[e._v("Engine: "+e._s(s.code)+" ")]),r("br"),r("span",{staticClass:"item-domain"},[e._v("Frame "+e._s(s.expiredAt)+" ")]),r("br"),r("span",{staticClass:"item-domain"},[e._v("Price "+e._s(s.price)+" ")])])])]}}],null,!1,949586475),model:{value:e.supplier,callback:function(t){e.supplier=t},expression:"supplier"}},[e._v(' // @search="setQuery"\n          '),r("template",{slot:"no-data"},[e._v("\n            We need at least 2 letters to search.\n          ")])],2)],1),r("b-row",[r("b-col",[r("b-form-group",{attrs:{label:"Supplier:","label-for":"supplier","invalid-feedback":e.$errors.first("supplier_id"),state:!e.$errors.has("supplier_id")}},[r("b-form-select",{attrs:{state:!e.$errors.has("supplier_id")},model:{value:e.form.supplierId,callback:function(t){e.$set(e.form,"supplierId",t)},expression:"form.supplierId"}},e._l(e.suppliers,function(t,s){return r("option",{key:"supplier-"+s,domProps:{value:t.id}},[e._v("\n                "+e._s(t.name)+"\n              ")])}),0)],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Received:","label-for":"received","invalid-feedback":e.$errors.first("received"),state:!e.$errors.has("received")}},[r("b-form-select",{attrs:{state:!e.$errors.has("received")},model:{value:e.form.received,callback:function(t){e.$set(e.form,"received",t)},expression:"form.received"}},[r("option",{attrs:{value:"1"}},[e._v("Received")]),r("option",{attrs:{value:"0"}},[e._v("Not Received")])])],1)],1)],1),r("div",{staticClass:"table-responsive"},[r("table",{staticClass:"table table-bordered table-hover"},[r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[e._v("#")]),r("th",{attrs:{scope:"col"}}),r("th",{attrs:{scope:"col"}},[e._v("Product")]),r("th",{attrs:{scope:"col"}},[e._v("Qty")]),r("th",{attrs:{scope:"col"}},[e._v("Cost")]),r("th",{attrs:{scope:"col"}},[e._v("Sub total")]),r("th",{attrs:{scope:"col"}})])]),r("tbody",[e._l(e.form.products,function(t,s){return r("tr",{key:"product-"+s},[r("th",{attrs:{scope:"row"}},[e._v(e._s(s+1))]),r("th",[r("b-img-lazy",{attrs:{src:t.file,width:"30",height:"30",alt:t.name,responsive:""}})],1),r("td",[e._v(e._s(t.name))]),r("td",[r("b-form-input",{attrs:{id:"product-qty",type:"number",state:!e.$errors.has("form.products[index].qty"),placeholder:"Enter product qty",step:".01"},model:{value:e.form.products[s].qty,callback:function(t){e.$set(e.form.products[s],"qty",t)},expression:"form.products[index].qty"}})],1),r("td",[r("b-form-input",{attrs:{id:"product-cost",type:"number",state:!e.$errors.has("form.products[index].cost"),placeholder:"Enter product cost",step:".01"},model:{value:e.form.products[s].cost,callback:function(t){e.$set(e.form.products[s],"cost",t)},expression:"form.products[index].cost"}})],1),r("td",[e._v(e._s(e.form.products[s].sub_total=e.subTotal(t)))]),r("td",[r("b-button",{attrs:{type:"button",variant:"danger",size:"sm"},on:{click:function(t){return e.removeItem(s)}}},[r("i",{staticClass:"fa fa-trash-o"})])],1)])}),r("tr",[r("th",{attrs:{colspan:"4"}},[e._v("Total")]),r("td",{attrs:{colspan:"3"}},[e._v(e._s(e.total))])])],2)])]),r("b-form-group",{attrs:{label:"Attachments:","label-for":"attachments","invalid-feedback":e.$errors.first("attachments"),state:!e.$errors.has("attachments")}},[r("b-form-file",{attrs:{placeholder:"Choose a file...","drop-placeholder":"Drop file here...",state:!e.$errors.has("attachments"),multiple:"",name:"attachments"},on:{change:e.handleFileSelect}})],1),r("b-form-group",{attrs:{label:"Notes:","label-for":"notes","invalid-feedback":e.$errors.first("notes"),state:!e.$errors.has("notes")}},[r("textarea-autosize",{attrs:{"input-name":"notes",placeholder:"Enter notes"},model:{value:e.form.notes,callback:function(t){e.$set(e.form,"notes",t)},expression:"form.notes"}})],1),r("v-button",{on:{click:e.goBack}})],1):e._e()],1)],1)},a=[],o=r("59ad"),n=r.n(o),c=r("e814"),i=r.n(c),l=(r("7f7f"),r("96cf"),r("3b8d")),u=r("cebc"),d=r("2f62"),p={name:"PurchaseCreate",middleware:"auth",metaInfo:function(){return{title:this.$t("settings")}},scrollToTop:!0,computed:Object(u["a"])({},Object(d["b"])({suppliers:"supplier/all",products:"product/all"}),{total:function(){return this.form.products.reduce(function(e,t){return e+t.qty*t.cost},0)}}),data:function(){return{form:{attachments:[],products:[]},show:!0,supplier:{}}},methods:{onSubmit:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.preventDefault(),this.form.date=this.form.date?this.$moment(this.form.date).format("YYYY-MM-DD HH:mm:ss"):"",e.next=4,this.$store.dispatch("purchase/create",this.form);case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),onReset:function(e){var t=this;e.preventDefault(),this.form.email="",this.form.description="",this.form.active=!0,this.show=!1,this.$nextTick(function(){t.show=!0})},goBack:function(){this.$router.push({name:"purchase.index"})},handleFileSelect:function(e){for(var t=e.target.files,r=0;r<t.length;r++)this.form.attachments.push(t[r])},selectedItem:function(e){var t=this;t.form.products.push({qty:1,cost:e.cost,name:e.name,file:e.file,product_id:e.id})},subTotal:function(e){return(i()(e.qty)*n()(e.cost)).toFixed(2)},removeItem:function(e){this.form.products.splice(e,1)}},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.watch(function(e){e.auth.authenticated&&(t.$store.dispatch("supplier/all",function(e){e.setParameters({all:!0})}),t.$store.dispatch("product/all",function(e){e.setParameters({all:!0})}))});case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),destroyed:function(){this.$errors.flush()}},f=p,m=r("2877"),h=Object(m["a"])(f,s,a,!1,null,null,null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0c9af9.d27a2204.js.map